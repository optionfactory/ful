{"version":3,"file":"ful-client-errors.iife.min.js","sources":["../src/client-errors.js"],"sourcesContent":["function ful_report_error(evt){\n    function meta_content(name) {\n        var metaEls = document.getElementsByTagName(\"meta\");\n        var content = [].slice.call(metaEls).filter(function (v) {\n            return v.name === name;\n        }).map(function (v) {\n            return v.content;\n        });\n        return content[0];\n    }\n    function configured_report_uri(){\n        var scriptEl = document.querySelector('script[data-report-client-errors-uri]');\n        if(!scriptEl){\n            console && console.error && console.error(\"missing attribute data-report-client-errors-uri\");\n            return null;\n        }\n        return scriptEl.dataset['reportClientErrorsUri'];\n    }\n    function split_stack(){\n        if(evt.error && evt.error.stack && evt.error.stack.split){\n            return evt.error.stack.split(\"\\n\");\n        }\n        if(evt.reason && evt.reason.stack && evt.reason.stack.split){\n            return evt.reason.stack.split(\"\\n\");\n        }\n        return undefined\n    }\n    function message(){\n        if(evt.message){\n            return evt.message;\n        }\n        if(evt.reason && evt.reason.message){\n            return evt.reason.message;\n        }\n        if(evt.error && evt.error.message){\n            return evt.error.message;\n        }\n        return undefined;\n    }\n\n    var uri = configured_report_uri();\n    if(!uri){\n        return;\n    }\n    var headers = {\n        'Content-Type': 'application/json'\n    };\n    headers[meta_content(\"_csrf_header\")] = meta_content(\"_csrf\");\n    try {\n        fetch(uri, {\n            method: 'POST',\n            mode: 'same-origin',\n            cache: 'no-cache',\n            credentials: 'same-origin',\n            headers: headers,\n            redirect: 'error',\n            referrerPolicy: 'no-referrer-when-downgrade',\n            body: JSON.stringify({\n                page: window.location && window.location.href ? window.location.href : \"unknown\",\n                filename: evt.filename,\n                line: evt.lineno,\n                col: evt.colno,\n                message: message(),\n                stack: split_stack()\n            })\n        });\n    } catch (e) {\n        //nothing to do here\n    }\n}\n\nwindow.addEventListener('error', ful_report_error);\nwindow.addEventListener('unhandledrejection', ful_report_error);\n"],"names":["ful_report_error","evt","meta_content","name","metaEls","document","getElementsByTagName","slice","call","filter","v","map","content","scriptEl","uri","querySelector","dataset","console","error","headers","fetch","method","mode","cache","credentials","redirect","referrerPolicy","body","JSON","stringify","page","window","location","href","filename","line","lineno","col","colno","message","reason","stack","split","e","addEventListener"],"mappings":"yBAAA,SAASA,EAAiBC,GACtB,SAASC,EAAaC,GAClB,IAAIC,EAAUC,SAASC,qBAAqB,QAM5C,MALc,GAAGC,MAAMC,KAAKJ,GAASK,QAAO,SAAUC,GAClD,OAAOA,EAAEP,OAASA,CAC9B,IAAWQ,KAAI,SAAUD,GACb,OAAOA,EAAEE,OACrB,IACuB,EAClB,CA+BD,IA7BQC,EA6BJC,GA7BID,EAAWR,SAASU,cAAc,0CAK/BF,EAASG,QAA+B,uBAH3CC,SAAWA,QAAQC,OAASD,QAAQC,MAAM,mDACnC,MA2Bf,GAAIJ,EAAJ,CAGA,IAAIK,EAAU,CACV,eAAgB,oBAEpBA,EAAQjB,EAAa,iBAAmBA,EAAa,SACrD,IACIkB,MAAMN,EAAK,CACPO,OAAQ,OACRC,KAAM,cACNC,MAAO,WACPC,YAAa,cACbL,QAASA,EACTM,SAAU,QACVC,eAAgB,6BAChBC,KAAMC,KAAKC,UAAU,CACjBC,KAAMC,OAAOC,UAAYD,OAAOC,SAASC,KAAOF,OAAOC,SAASC,KAAO,UACvEC,SAAUjC,EAAIiC,SACdC,KAAMlC,EAAImC,OACVC,IAAKpC,EAAIqC,MACTC,QAlCLtC,EAAIsC,QACItC,EAAIsC,QAEZtC,EAAIuC,QAAUvC,EAAIuC,OAAOD,QACjBtC,EAAIuC,OAAOD,QAEnBtC,EAAIiB,OAASjB,EAAIiB,MAAMqB,QACftC,EAAIiB,MAAMqB,aADrB,EA6BQE,MA5CLxC,EAAIiB,OAASjB,EAAIiB,MAAMuB,OAASxC,EAAIiB,MAAMuB,MAAMC,MACxCzC,EAAIiB,MAAMuB,MAAMC,MAAM,MAE9BzC,EAAIuC,QAAUvC,EAAIuC,OAAOC,OAASxC,EAAIuC,OAAOC,MAAMC,MAC3CzC,EAAIuC,OAAOC,MAAMC,MAAM,WADlC,KA8CH,CAFC,MAAOC,GAER,CAzBA,CA0BL,CAEAZ,OAAOa,iBAAiB,QAAS5C,GACjC+B,OAAOa,iBAAiB,qBAAsB5C"}