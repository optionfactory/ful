var ful=function(e){"use strict";function t(e,t,r,s,i){const o=e[t.dataset.bindMutator]||e[t.dataset.bindProvide];o?o(t,r,s,i):t.value=r}class r{static STANDARD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";static URL_SAFE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static encode(e,t){const s=t||r.URL_SAFE,i=e.byteLength,o=new Uint8Array(e);let n="";for(let e=0;e<i;e+=3){n+=s[o[e]>>2]+s[(3&o[e])<<4|o[e+1]>>4]+s[(15&o[e+1])<<2|o[e+2]>>6]+s[63&o[e+2]]}return i%3==2?n=n.substring(0,n.length-1):i%3==1&&(n=n.substring(0,n.length-2)),n}static decode(e,t){const s=t||r.URL_SAFE;let i=Math.floor(.75*e.length);for(let t=0;t!==e.length&&"="===e[e.length-t-1];++t)--i;const o=new Uint8Array(i);let n=0,a=0;for(;n<.75*e.length;){const t=s.indexOf(e.charAt(a++)),r=s.indexOf(e.charAt(a++)),i=s.indexOf(e.charAt(a++)),c=s.indexOf(e.charAt(a++));o[n++]=t<<2|r>>4,o[n++]=(15&r)<<4|i>>2,o[n++]=(3&i)<<6|c}return o.buffer}}class s{static DEFAULT_FIELD_CONTAINER_SELECTOR="label";static DEFAULT_ERROR_CLASS="has-error";static DEFAULT_HIDE_CLASS="d-none";el;bindings;globalErrorsEl;fieldContainerSelector;errorClass;hideClass;constructor(e,t,{globalErrorsEl:r,fieldContainerSelector:i,errorClass:o,hideClass:n}){this.el=e,this.bindings=t,this.globalErrorsEl=r,this.fieldContainerSelector=void 0!==i?i:s.DEFAULT_FIELD_CONTAINER_SELECTOR,this.errorClass=o||s.DEFAULT_ERROR_CLASS,this.hideClass=n||s.DEFAULT_HIDE_CLASS}setValues(e){return this.bindings.setValues(this.el,e)}getValues(){return this.bindings.getValues(this.el)}setErrors(e,t){if(this.clearErrors(),e.map(this.mapError?this.mapError:e=>e).filter((e=>"FIELD_ERROR"===e.type||"INVALID_FORMAT"===e.type)).forEach((e=>{const t=e.context.replace("[",".").replace("].",".");Array.from(document.querySelectorAll(this.el,`[name='${CSS.escape(t)}']`)).map((e=>this.fieldContainerSelector?e.closest(this.fieldContainerSelector):e)).filter((e=>null!==e)).forEach((t=>{t.classList.add(this.errorClass),t.dataset.error=e.reason}))})),this.globalErrorsEl){const t=e.filter((e=>"FIELD_ERROR"!==e.type&&"INVALID_FORMAT"!==e.type));this.globalErrorsEl.innerHTML=t.join("\n"),0!==t.length&&this.globalErrorsEl.classList.remove(this.hideClass)}if(!t)return;const r=Array.from(this.el.querySelectorAll(".${CSS.escape(this.errorClass)}")).map((e=>e.getBoundingClientRect().y+window.scrollY)),s=Math.min(...r);s!==1/0&&window.scroll(window.scrollX,s>100?s-100:0)}clearErrors(){this.el.all(".${CSS.escape(this.errorClass)}").forEach((e=>e.classList.remove(this.errorClass))),this.globalErrorsEl.innerHTML="",this.globalErrorsEl.classList.add(this.hideClass)}}class i{constructor(){const e=document.querySelector("meta[name='context']").getAttribute("content");this.context=e.endsWith("/")?e.substring(0,e.length-1):e}before(e){const t=e.resource.startsWith("/")?"":"/";e.resource=this.context+t+e.resource}}class o{k;v;constructor(){this.k=document.querySelector("meta[name='_csrf_header']").getAttribute("content"),this.v=document.querySelector("meta[name='_csrf']").getAttribute("content")}before(e){const t=new Headers(e.options.headers);t.set(this.k,this.v),e.options.headers=t}}class n{constructor(e){this.redirectUri=e}after(e,t){401===t.status&&(window.location.href=redirectUri)}}class a{interceptors;constructor(){this.interceptors=[]}withContext(){return this.interceptors.push(new i),this}withCsrfToken(){return this.interceptors.push(new o),this}withRedirectOnUnauthorized(e){return this.interceptors.push(new n(e)),this}withInterceptors(...e){return this.interceptors.push(...e),this}build(){const e=this.interceptors;return new c({interceptors:e})}}class c{interceptors;static builder(){return new a}constructor({interceptors:e}){this.interceptors=e||[]}async fetch(e,t){const r=this.interceptors.reduce((async(e,t)=>t.before?await t.before(e):e),{resource:e,options:t}),s=await fetch(r.resource,r.options);return this.interceptors.reduce((async(e,t)=>t.after?await t.after(r,e):e),s)}}class l{prefix;type;constructor(e,t){this.prefix=e,this.storagte=t}put(e,t){this.storage.setItem(this.prefix+"-"+e,JSON.stringify(t))}pop(e){const t=this.storage.getItem(this.prefix+"-"+e),r=void 0===t?void 0:JSON.parse(t);return this.storage.removeItem(e),r}}class h extends l{constructor(e){super(e,sessionStorage)}}class u{static PKCE_AND_STATE_KEY="state-and-verifier";static forKeycloak(e,t,r){const s=new URL("protocol/openid-connect/auth",t),i=new URL("protocol/openid-connect/token",t),o=new URL("protocol/openid-connect/lgout",t);return new u(e,"openid profile",s,i,o,r)}constructor(e,t,r,s,i,o){this.clientId=e,this.scope=t,this.authUri=r,this.tokenUri=s,this.logoutUri=i,this.redirectUri=o,this.storage=new h(e)}_auth(){const e=r.encode(crypto.getRandomValues(new Uint8Array(32)).buffer),t=r.encode(crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e))),s=this.clientId+r.encode(crypto.getRandomValues(new Uint8Array(16)).buffer);this.storage.put(u.PKCE_AND_STATE_KEY,{state:s,verifier:e});let i=new URL(this.authUri);i.searchParams.set("client_id",this.clientId),i.searchParams.set("redirect_uri",this.redirectUri),i.searchParams.set("response_type","code"),i.searchParams.set("scope",this.scope),i.searchParams.set("state",s),i.searchParams.set("code_challenge",t),i.searchParams.set("code_challenge_method","S256"),window.location=i}async _tokenExchange(e,t){window.history.replaceState("","",this.redirectUri);let r=this.storage.pop(u.PKCE_AND_STATE_KEY);if(r.state!==t)throw new Error("State mismatch");let s=await fetch(this.tokenUri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams([["client_id",this.clientId],["code",e],["grant_type","authorization_code"],["code_verifier",r.verifier],["state",r.state],["redirect_uri",this.redirectUri]])});if(!s.ok){let e=await s.text();throw new Error("Error:"+s.status+": "+e)}let i=await s.json();return new d(this.clientId,i,this.tokenUri,this.logoutUri,this.redirectUri)}async ensureLoggedIn(){const e=new URL(window.location.href),t=e.searchParams.get("code");if(t){const r=e.searchParams.get("state");return await this._tokenExchange(t,r)}return this._auth(),null}}class d{static parseToken(e){const[t,r,s]=e.split(".");return{header:JSON.parse(atob(t)),payload:JSON.parse(atob(r)),signature:s}}constructor(e,t,r,s,i){this.clientId=e,this.token=t,this.tokenUri=r,this.logoutUri=s,this.redirectUri=i,this.accessToken=d.parseToken(t.access_token),this.refreshToken=d.parseToken(t.refresh_token),this.refreshCallback=null}onRefresh(e){this.refreshCallback=e}async refresh(){let e=await fetch(this.tokenUri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams([["client_id",this.clientId],["grant_type","refresh_token"],["refresh_token",this.token.refresh_token]])});if(!e.ok)throw new Error("Error:"+e.code+": "+e.text());const t=await e.json();this.token=t,this.accessToken=this._parseToken(t.access_token),this.refreshToken=this._parseToken(t.refresh_token),this.refreshCallback&&this.refreshCallback(this.token,this.accessToken,this.refreshToken)}shouldBeRefreshed(e){const t=(new Date).getTime(),r=1e3*this.refreshToken.payload.exp;return!(t>r)&&t-e>r}async refreshIf(e){this.shouldBeRefreshed(e)&&await this.refresh()}logout(){let e=new URL(this.logoutUri);e.searchParams.set("post_logout_redirect_uri",this.redirectUri),e.searchParams.set("id_token_hint",this.token.id_token),window.location=e}bearerToken(){return`Bearer ${this.token.access_token}`}interceptor(e,t){return new f(this,e,t)}}class f{session;gracePeriodBefore;gracePeriodAfter;constructor(e,t,r){this.session=e,this.gracePeriodBefore=t||2e3,this.gracePeriodAfter=r||3e4}async before(e){await this.session.refreshIfNeeded(this.gracePeriodBefore);return new Headers(e.options.headers).set("Authorization",this.session.bearerToken()),e}async after(e,t){return await this.session.refreshIfNeeded(this.gracePeriodAfter),t}}const p={sleep:e=>new Promise((t=>setTimeout(t,e))),DEBOUNCE_DEFAULT:0,DEBOUNCE_IMMEDIATE:1,debounce(e,t,r){let s=null,i=[],o=0,n=r||p.DEBOUNCE_DEFAULT;const a=()=>{const r=(new Date).getTime()-o;e>r?s=setTimeout(a,e-r):(s=null,n!==p.DEBOUNCE_IMMEDIATE&&t(...i),null===s&&(i=[]))};return function(){i=arguments,o=(new Date).getTime(),null===s&&(s=setTimeout(a,e),n===p.DEBOUNCE_IMMEDIATE&&t(...i))}},THROTTLE_DEFAULT:0,THROTTLE_NO_LEADING:1,THROTTLE_NO_TRAILING:2,throttle(e,t,r){let s=null,i=[],o=0,n=r||p.THROTTLE_DEFAULT;const a=()=>{o=n&p.THROTTLE_NO_LEADING?0:(new Date).getTime(),s=null,t(...i),null===s&&(i=[])};return function(){const r=(new Date).getTime();!o&&n&p.THROTTLE_NO_LEADING&&(o=r);const c=e-(r-o);i=arguments,c<=0||c>e?(null!==s&&(clearTimeout(s),s=null),o=r,t(...i),null===s&&(i=[])):null!==s||n&p.THROTTLE_NO_TRAILING||(s=setTimeout(a,c))}}};return e.AuthorizationCodeFlow=u,e.AuthorizationCodeFlowInterceptor=f,e.AuthorizationCodeFlowSession=d,e.Base64=r,e.Bindings=class{extractors;mutators;valueHoldersSelector;ignoredChildrenSelector;constructor({extractors:e,mutators:t,ignoredChildrenSelector:r,valueHoldersSelector:s}){this.extractors=e||{},this.mutators=t||{},this.valueHoldersSelector=s||"input[name], select[name], textarea[name]",this.ignoredChildrenSelector=r||".d-none"}setValues(e,r){for(let s in r){if(!r.hasOwnProperty(s))continue;const i=e.querySelector(`[name='${CSS.escape(s)}']`);t(this.mutators,i,r[s],s,r)}}getValues(e){return Array.from(e.querySelectorAll(this.valueHoldersSelector)).filter((e=>"never"!==e.dataset.bindInclude&&("always"===e.dataset.bindInclude||null===e.closest(this.ignoredChildrenSelector)))).reduce(((e,t)=>function(e,t,r){const s=t.split(".").map((e=>e.match(/^[0-9]+$/)?+e:e));let i=e,o=null;for(let t=0;;++t){const n=s[t],a=s[t-1];if(Number.isInteger(n)&&!Array.isArray(i)&&(null!==o?o[a]=i=[]:e=i=[]),t===s.length-1)return i[n]=void 0!==r?r:n in i?i[n]:null,e;void 0===i[n]&&(i[n]={}),o=i,i=i[n]}}(e,t.getAttribute("name"),function(e,t){const r=e[t.dataset.bindExtractor]||e[t.dataset.bindProvide];if(r)return r(t);if("radio"===t.getAttribute("type")){if(!t.checked)return;return"boolean"===t.dataset.bindType?"true"===t.value:t.value}return"checkbox"===t.getAttribute("type")?t.checked:"boolean"===t.dataset.bindType?t.value?"true"===t.value:null:t.value||null}(this.extractors,t))),{})}},e.Form=s,e.HttpClient=c,e.LocalStorage=class extends l{constructor(e){super(e,localStorage)}},e.SessionStorage=h,e.Wizard=class{constructor(e){if(this.el=e,this.progress=[...e.querySelectorAll("header,ol,ul")],this.progress.forEach((e=>{null===e.querySelector(":scope > .active")&&e.children[0].classList.add("active")})),null===this.el.querySelector("section.current")){const e=this.el.querySelector("section:first-of-type");null!==e&&e.classList.add("current")}}next(){this.progress.forEach((e=>{const t=e.querySelector(":scope > .active");t.classList.remove("active"),t.nextElementSibling.classList.add("active")}));const e=this.el.querySelector("section.current");e.classList.remove("current"),e.nextElementSibling.classList.add("current"),this.el.dispatchEvent(new CustomEvent("wizard:activate",{bubbles:!0,cancelable:!0}))}prev(){this.progress.forEach((e=>{const t=e.querySelector(":scope > .active");t.classList.remove("active"),t.previousElementSibling.classList.add("active")}));const e=this.el.querySelector("section.current");e.classList.remove("current"),e.previousElementSibling.classList.add("current"),this.el.dispatchEvent(new CustomEvent("wizard:activate",{bubbles:!0,cancelable:!0}))}moveTo=function(e){this.progress.forEach((t=>{t.querySelector(":scope > .active")?.classList.remove("active"),t.children[+e].classList.add("active")}));this.el.querySelector("section.current")?.classList.remove("current");this.el.querySelector(`section:nth-child('${+e}')`).classList.add("current"),this.el.dispatchEvent(new CustomEvent("wizard:activate",{bubbles:!0,cancelable:!0}))}},e.timing=p,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=ful.iife.min.js.map
