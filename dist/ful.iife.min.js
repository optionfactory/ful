var ful=function(e){"use strict";function t(e,t,r,s,o){const i=e[t.dataset.bindMutator]||e[t.dataset.bindProvide];i?i(t,r,s,o):"radio"!==t.getAttribute("type")?"checkbox"!==t.getAttribute("type")?t.value=r:t.checked=r:t.checked=t.getAttribute("value")===r}class r{static STANDARD="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";static URL_SAFE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static encode(e,t){const s=t||r.URL_SAFE,o=e.byteLength,i=new Uint8Array(e);let n="";for(let e=0;e<o;e+=3){n+=s[i[e]>>2]+s[(3&i[e])<<4|i[e+1]>>4]+s[(15&i[e+1])<<2|i[e+2]>>6]+s[63&i[e+2]]}return o%3==2?n=n.substring(0,n.length-1):o%3==1&&(n=n.substring(0,n.length-2)),n}static decode(e,t){const s=t||r.URL_SAFE;let o=Math.floor(.75*e.length);for(let t=0;t!==e.length&&"="===e[e.length-t-1];++t)--o;const i=new Uint8Array(o);let n=0,a=0;for(;n<.75*e.length;){const t=s.indexOf(e.charAt(a++)),r=s.indexOf(e.charAt(a++)),o=s.indexOf(e.charAt(a++)),c=s.indexOf(e.charAt(a++));i[n++]=t<<2|r>>4,i[n++]=(15&r)<<4|o>>2,i[n++]=(3&o)<<6|c}return i.buffer}}class s{static DEFAULT_FIELD_CONTAINER_SELECTOR="label";static DEFAULT_ERROR_CLASS="has-error";static DEFAULT_HIDE_CLASS="d-none";el;bindings;globalErrorsEl;fieldContainerSelector;errorClass;hideClass;constructor(e,t,{globalErrorsEl:r,fieldContainerSelector:o,errorClass:i,hideClass:n}){this.el=e,this.bindings=t,this.globalErrorsEl=r,this.fieldContainerSelector=void 0!==o?o:s.DEFAULT_FIELD_CONTAINER_SELECTOR,this.errorClass=i||s.DEFAULT_ERROR_CLASS,this.hideClass=n||s.DEFAULT_HIDE_CLASS}setValues(e){return this.bindings.setValues(this.el,e)}getValues(){return this.bindings.getValues(this.el)}setErrors(e,t,r){if(this.clearErrors(),e.map(this.mapError?this.mapError:e=>e).filter((e=>"FIELD_ERROR"===e.type||"INVALID_FORMAT"===e.type)).forEach((e=>{const t=e.context.replace("[",".").replace("].",".");Array.from(this.el.querySelectorAll(`[name='${CSS.escape(t)}']`)).map((e=>this.fieldContainerSelector?e.closest(this.fieldContainerSelector):e)).filter((e=>null!==e)).forEach((t=>{t.classList.add(this.errorClass),t.dataset.error=e.reason}))})),this.globalErrorsEl){const t=e.filter((e=>"FIELD_ERROR"!==e.type&&"INVALID_FORMAT"!==e.type));this.globalErrorsEl.innerHTML=t.map((e=>e.reason)).join("\n"),0!==t.length&&this.globalErrorsEl.classList.remove(this.hideClass)}if(!t)return;const s=Array.from(this.el.querySelectorAll(".${CSS.escape(this.errorClass)}")).map((e=>e.getBoundingClientRect().y+window.scrollY)),o=Math.min(...s);o!==1/0&&window.scroll(window.scrollX,o>100?o-100:0)}clearErrors(){this.el.querySelectorAll(`.${CSS.escape(this.errorClass)}`).forEach((e=>e.classList.remove(this.errorClass))),this.globalErrorsEl&&(this.globalErrorsEl.innerHTML="",this.globalErrorsEl.classList.add(this.hideClass))}}class o{constructor(){const e=document.querySelector("meta[name='context']").getAttribute("content");this.context=e.endsWith("/")?e.substring(0,e.length-1):e}before(e){const t=e.resource.startsWith("/")?"":"/";e.resource=this.context+t+e.resource}}class i{k;v;constructor(){this.k=document.querySelector("meta[name='_csrf_header']").getAttribute("content"),this.v=document.querySelector("meta[name='_csrf']").getAttribute("content")}before(e){const t=new Headers(e.options.headers);t.set(this.k,this.v),e.options.headers=t}}class n{constructor(e){this.redirectUri=e}after(e,t){401===t.status&&(window.location.href=redirectUri)}}class a extends Error{problems;static parseProblems(e,t){const r=[{type:"GENERIC_PROBLEM",context:null,reason:`${e}: ${t}`,details:null}];try{return t?JSON.parse(t):r}catch(e){return r}}static fromResponse(e,t){return new a(e,a.parseProblems(e,t))}constructor(e,t){super(JSON.stringify(t)),this.name=`Failure:${e}`,this.status=e,this.problems=t}}class c{interceptors;constructor(){this.interceptors=[]}withContext(){return this.interceptors.push(new o),this}withCsrfToken(){return this.interceptors.push(new i),this}withRedirectOnUnauthorized(e){return this.interceptors.push(new n(e)),this}withInterceptors(...e){return this.interceptors.push(...e),this}build(){const e=this.interceptors;return new l({interceptors:e})}}class l{interceptors;static builder(){return new c}constructor({interceptors:e}){this.interceptors=e||[]}async fetch(e,t){const r=this.interceptors.concat(t.interceptors||[]),s={resource:e,options:t};await r.forEach((async e=>{e.before&&await e.before(s)}));const o=await fetch(s.resource,s.options);return await r.forEach((async e=>{e.after&&await e.after(s,o)})),o}async json(e,t){try{const r=await this.fetch(e,t);if(!r.ok){const e=await r.text();throw a.fromResponse(r.status,e)}const s=await r.text();return s?JSON.parse(s):void 0}catch(e){if(e instanceof a)throw e;throw new a(0,[{type:"CONNECTION_PROBLEM",context:null,reason:e.message,details:null}])}}async form(e,t,r){const s=r||{};s.buttons?.forEach((e=>{e.setAttribute("disabled","disabled"),s.loader&&(e.dataset.oldContent=e.innerHTML,e.innerHTML=s.loader)}));try{const r=await this.json(e,t);return s.form?.clearErrors(),r}catch(e){throw s.form?.setErrors(e.problems),e}finally{s.buttons?.forEach((e=>{e.removeAttribute("disabled"),e.innerHTML=e.dataset.oldContent,delete e.dataset.oldContent}))}}}class h{prefix;type;constructor(e,t){this.prefix=e,this.storage=t}save(e,t){this.storage.setItem(`${this.prefix}-${e}`,JSON.stringify(t))}load(e){const t=this.storage.getItem(`${this.prefix}-${e}`);return void 0===t?void 0:JSON.parse(t)}remove(e){this.storage.removeItem(`${this.prefix}-${e}`)}pop(e){const t=this.access(e);return this.remove(e),t}}class u extends h{constructor(e){super(e,sessionStorage)}}class d{static PKCE_AND_STATE_KEY="state-and-verifier";static forKeycloak(e,t,r){const s=new URL("protocol/openid-connect/auth",t),o=new URL("protocol/openid-connect/token",t),i=new URL("protocol/openid-connect/lgout",t);return new d(e,"openid profile",s,o,i,r)}constructor(e,t,r,s,o,i){this.clientId=e,this.scope=t,this.authUri=r,this.tokenUri=s,this.logoutUri=o,this.redirectUri=i,this.storage=new u(e)}_auth(){const e=r.encode(crypto.getRandomValues(new Uint8Array(32)).buffer),t=r.encode(crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e))),s=this.clientId+r.encode(crypto.getRandomValues(new Uint8Array(16)).buffer);this.storage.save(d.PKCE_AND_STATE_KEY,{state:s,verifier:e});const o=new URL(this.authUri);o.searchParams.set("client_id",this.clientId),o.searchParams.set("redirect_uri",this.redirectUri),o.searchParams.set("response_type","code"),o.searchParams.set("scope",this.scope),o.searchParams.set("state",s),o.searchParams.set("code_challenge",t),o.searchParams.set("code_challenge_method","S256"),window.location=o}async _tokenExchange(e,t){window.history.replaceState("","",this.redirectUri);const r=this.storage.pop(d.PKCE_AND_STATE_KEY);if(r.state!==t)throw new Error("State mismatch");const s=await fetch(this.tokenUri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams([["client_id",this.clientId],["code",e],["grant_type","authorization_code"],["code_verifier",r.verifier],["state",r.state],["redirect_uri",this.redirectUri]])});if(!s.ok){const e=await s.text();throw new Error("Error:"+s.status+": "+e)}const o=await s.json();return new f(this.clientId,o,this.tokenUri,this.logoutUri,this.redirectUri)}async ensureLoggedIn(){const e=new URL(window.location.href),t=e.searchParams.get("code");if(t){const r=e.searchParams.get("state");return await this._tokenExchange(t,r)}return this._auth(),null}}class f{static parseToken(e){const[t,r,s]=e.split(".");return{header:JSON.parse(atob(t)),payload:JSON.parse(atob(r)),signature:s}}constructor(e,t,r,s,o){this.clientId=e,this.token=t,this.tokenUri=r,this.logoutUri=s,this.redirectUri=o,this.accessToken=f.parseToken(t.access_token),this.refreshToken=f.parseToken(t.refresh_token),this.refreshCallback=null}onRefresh(e){this.refreshCallback=e}async refresh(){const e=await fetch(this.tokenUri,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams([["client_id",this.clientId],["grant_type","refresh_token"],["refresh_token",this.token.refresh_token]])});if(!e.ok)throw new Error("Error:"+e.code+": "+e.text());const t=await e.json();this.token=t,this.accessToken=this._parseToken(t.access_token),this.refreshToken=this._parseToken(t.refresh_token),this.refreshCallback&&this.refreshCallback(this.token,this.accessToken,this.refreshToken)}shouldBeRefreshed(e){const t=(new Date).getTime(),r=1e3*this.refreshToken.payload.exp;return!(t>r)&&t-e>r}async refreshIf(e){this.shouldBeRefreshed(e)&&await this.refresh()}logout(){const e=new URL(this.logoutUri);e.searchParams.set("post_logout_redirect_uri",this.redirectUri),e.searchParams.set("id_token_hint",this.token.id_token),window.location=e}bearerToken(){return`Bearer ${this.token.access_token}`}interceptor(e,t){return new p(this,e,t)}}class p{session;gracePeriodBefore;gracePeriodAfter;constructor(e,t,r){this.session=e,this.gracePeriodBefore=t||2e3,this.gracePeriodAfter=r||3e4}async before(e){await this.session.refreshIf(this.gracePeriodBefore);return new Headers(e.options.headers).set("Authorization",this.session.bearerToken()),e}async after(e,t){return await this.session.refreshIf(this.gracePeriodAfter),t}}const E={sleep:e=>new Promise((t=>setTimeout(t,e))),DEBOUNCE_DEFAULT:0,DEBOUNCE_IMMEDIATE:1,debounce(e,t,r){let s=null,o=[],i=0,n=r||E.DEBOUNCE_DEFAULT;const a=()=>{const r=(new Date).getTime()-i;e>r?s=setTimeout(a,e-r):(s=null,n!==E.DEBOUNCE_IMMEDIATE&&t(...o),null===s&&(o=[]))};return function(){o=arguments,i=(new Date).getTime(),null===s&&(s=setTimeout(a,e),n===E.DEBOUNCE_IMMEDIATE&&t(...o))}},THROTTLE_DEFAULT:0,THROTTLE_NO_LEADING:1,THROTTLE_NO_TRAILING:2,throttle(e,t,r){let s=null,o=[],i=0,n=r||E.THROTTLE_DEFAULT;const a=()=>{i=n&E.THROTTLE_NO_LEADING?0:(new Date).getTime(),s=null,t(...o),null===s&&(o=[])};return function(){const r=(new Date).getTime();!i&&n&E.THROTTLE_NO_LEADING&&(i=r);const c=e-(r-i);o=arguments,c<=0||c>e?(null!==s&&(clearTimeout(s),s=null),i=r,t(...o),null===s&&(o=[])):null!==s||n&E.THROTTLE_NO_TRAILING||(s=setTimeout(a,c))}}};return e.AuthorizationCodeFlow=d,e.AuthorizationCodeFlowInterceptor=p,e.AuthorizationCodeFlowSession=f,e.Base64=r,e.Bindings=class{extractors;mutators;valueHoldersSelector;ignoredChildrenSelector;constructor({extractors:e,mutators:t,ignoredChildrenSelector:r,valueHoldersSelector:s}){this.extractors=e||{},this.mutators=t||{},this.valueHoldersSelector=s||"input[name], select[name], textarea[name]",this.ignoredChildrenSelector=r||".d-none"}setValues(e,r){for(let s in r)r.hasOwnProperty(s)&&Array.from(e.querySelectorAll(`[name='${CSS.escape(s)}']`)).forEach((e=>{t(this.mutators,e,r[s],s,r)}))}getValues(e){return Array.from(e.querySelectorAll(this.valueHoldersSelector)).filter((e=>"never"!==e.dataset.bindInclude&&("always"===e.dataset.bindInclude||null===e.closest(this.ignoredChildrenSelector)))).reduce(((e,t)=>function(e,t,r){const s=t.split(".").map((e=>e.match(/^[0-9]+$/)?+e:e));let o=e,i=null;for(let t=0;;++t){const n=s[t],a=s[t-1];if(Number.isInteger(n)&&!Array.isArray(o)&&(null!==i?i[a]=o=[]:e=o=[]),t===s.length-1)return o[n]=void 0!==r?r:n in o?o[n]:null,e;void 0===o[n]&&(o[n]={}),i=o,o=o[n]}}(e,t.getAttribute("name"),function(e,t){const r=e[t.dataset.bindExtractor]||e[t.dataset.bindProvide];if(r)return r(t);if("radio"===t.getAttribute("type")){if(!t.checked)return;return"boolean"===t.dataset.bindType?"true"===t.value:t.value}return"checkbox"===t.getAttribute("type")?t.checked:"boolean"===t.dataset.bindType?t.value?"true"===t.value:null:t.value||null}(this.extractors,t))),{})}},e.Failure=a,e.Form=s,e.Hex=class{static decode(e){if(e.length%2!=0)throw new Error("invalid length");const t=e.length/2;return new Uint8Array(t).map(((t,r)=>{const s=2*r,o=e.substring(s,s+2);return parseInt(o,16)}))}static encode(e,t){return Array.from(e).map((e=>e.toString(16))).map((e=>t?e.toUpperCase():e)).map((e=>e.padStart(2,0))).join("")}},e.HttpClient=l,e.LocalStorage=class extends h{constructor(e){super(e,localStorage)}},e.SessionStorage=u,e.Wizard=class{constructor(e){if(this.el=e,this.progress=[...e.children].filter((e=>e.matches("header,ol,ul"))),this.progress.forEach((e=>{const t=[...e.children];void 0===t.filter((e=>e.matches(".active")))[0]&&t.length>0&&t[0].classList.add("active")})),null===this.el.querySelector("section.current")){const e=this.el.querySelector("section:first-of-type");null!==e&&e.classList.add("current")}}next(){this.progress.forEach((e=>{const t=[...e.children].filter((e=>e.matches(".active")))[0];t?.classList.remove("active"),t?.nextElementSibling?.classList.add("active")}));const e=this.el.querySelector("section.current");e.classList.remove("current"),e.nextElementSibling.classList.add("current"),this.el.dispatchEvent(new CustomEvent("wizard:activate",{bubbles:!0,cancelable:!0}))}prev(){this.progress.forEach((e=>{const t=[...e.children].filter((e=>e.matches(".active")))[0];t?.classList.remove("active"),t?.previousElementSibling?.classList.add("active")}));const e=this.el.querySelector("section.current");e.classList.remove("current"),e.previousElementSibling.classList.add("current"),this.el.dispatchEvent(new CustomEvent("wizard:activate",{bubbles:!0,cancelable:!0}))}moveTo=function(e){this.progress.forEach((t=>{[...t.children].filter((e=>e.matches(".active")))[0]?.classList.remove("active"),t.children[+e]?.classList.add("active")}));this.el.querySelector("section.current")?.classList.remove("current");this.el.querySelector(`section:nth-child(${+e})`).classList.add("current"),this.el.dispatchEvent(new CustomEvent("wizard:activate",{bubbles:!0,cancelable:!0}))}},e.timing=E,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=ful.iife.min.js.map
