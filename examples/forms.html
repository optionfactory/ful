<html lang="it">

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.bootstrap5.min.css" integrity="sha256-4MwGlgBoHJALXjs2YKZb4sMqhSw7+yMymHAoa0cwJGE=" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js" integrity="sha256-KNeF6xW5o/tW1oae5XlS4JCNADoM+RHqrnoUqL6pvHY=" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/@optionfactory/ftl@1.0.3/dist/ftl.iife.min.js" crossorigin="anonymous"></script>

    <link href="../dist/ful.css" rel="stylesheet">
    <script src="../dist/ful.iife.min.js"></script>
    <script>
        const sleep = ful.timing.sleep;
        const Failure = ful.Failure;

        ftl.elements.define('ful-spinner', ful.Spinner)
            .define('ful-input', ful.Input)
            .define('ful-radio-group', ful.RadioGroup)
            .define('ful-select', ful.Select)
            .define('ful-form', ful.Form)
            .configure();
    </script>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <ful-form class="col-6 border border-primary" scroll-on-error>
                <h1>Classic layout</h1>
                <ful-input name="text.plain" class="mb-3" value="123">
                    text plain <sup>*</sup>

                </ful-input>
                <ful-input name="text.icons.before" class="mb-3">
                    Text with icon before
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                </ful-input>
                <ful-input name="text.icons.after" class="mb-3">
                    Text with icon after
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                </ful-input>
                <ful-input name="text.icons.both" class="mb-3">
                    Text with icons
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                </ful-input>
                <ful-input name="datetime" input-type="datetime-local" class="mb-3">
                    datetime-local
                </ful-input>
                <ful-input name="date" input-type="date" class="mb-3">
                    date
                </ful-input>
                <ful-input name="time" input-type="time" class="mb-3">
                    time
                </ful-input>
                <ful-select name="select.single.local.noicons" class="mb-3">
                    select local single no icons
                    <select slot="input" class="form-select">
                        <option value="16">aaa</option>
                        <option value="17">zzz</option>
                    </select>
                </ful-select>

                <ful-select name="select.single.local.iconbefore" class="mb-3">
                    select local single icon before
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <select slot="input" class="form-select">
                        <option value="16">aaa</option>
                        <option value="17">zzz</option>
                    </select>
                </ful-select>

                <ful-select name="select.single.local.iconafter" class="mb-3">
                    select local single icon after
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                    <select slot="input" class="form-select">
                        <option value="16">aaa</option>
                        <option value="17">zzz</option>
                    </select>
                </ful-select>

                <ful-select name="select.single.local.icons" class="mb-3">
                    select local single 2 icons
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                    <select slot="input" class="form-select">
                        <option value="16">aaa</option>
                        <option value="17">zzz</option>
                    </select>
                </ful-select>
                <ful-select type="remote" name="select.single.remote" input-class="form-select" class="mb-3" value="1">
                    select remote single
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                </ful-select>
                <ful-select type="remote" name="select.multiple.remote" input-class="form-select" input-multiple
                    class="mb-3">
                    select remote multiple
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                </ful-select>
                <ful-radio-group name="radio.vertical" class="mb-3">
                    A vertical radio group
                    <ful-radio value="one">One</ful-radio>
                    <ful-radio value="two">Two</ful-radio>
                </ful-radio-group>

                <ful-radio-group name="radio.horizontal" class="mb-3 horizontal">
                    An horizontal radio group
                    <ful-radio value="one">One</ful-radio>
                    <ful-radio value="two">Two</ful-radio>
                </ful-radio-group>


                <ful-errors hidden></ful-errors>

                <button type="submit" class="btn btn-primary">
                    <ful-spinner hidden></ful-spinner>
                    submit
                </button>
            </ful-form>
            <ful-form class="col-6 border border-primary">
                <h1>Classic layout big</h1>
                <ful-input name="blasd1" class="mb-3">
                    Label1 <sup>*</sup>
                    <input slot="input" class="form-control form-control-lg">
                </ful-input>
                <ful-select type="remote" name="tomselect.single" class="mb-3" input-class="form-control-lg">
                    select single
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                </ful-select>
                <ful-select type="remote" name="tomselect.multiple" input-multiple class="mb-3"
                    input-class="form-control-lg">
                    select multiple
                    <i slot="ibefore" class="bi bi-envelope-at"></i>
                    <i slot="iafter" class="bi bi-envelope-at"></i>
                </ful-select>
            </ful-form>
        </div>
    </div>
    <script>





        document.addEventListener("DOMContentLoaded", () => {


            document.querySelectorAll('ful-select').forEach(el => {
                el.addEventListener('change', evt => {
                    console.log("ful-select changed", evt);
                });
            })

            document.querySelector('[name="radio.horizontal"]').addEventListener('change', evt => {
                console.log("event:val", evt, evt.currentTarget, evt.target, "cancelable", evt.cancelable);
            });


            document.querySelectorAll('ful-form').forEach(form => {
                form.submitter = async (data, form) => {
                    await sleep(2_000);
                    throw new Failure(0, [{
                        type: 'FIELD_ERROR',
                        context: 'text.plain',
                        reason: 'text.plain error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'text.icons.before',
                        reason: 'text icons before error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'text.icons.after',
                        reason: 'text icons after error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'text.icons.both',
                        reason: 'text.icons.both error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'datetime',
                        reason: 'datetime error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'date',
                        reason: 'date error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'time',
                        reason: 'time error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'select.single.local.noicons',
                        reason: 'select.single.local.noicons error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'select.single.local.iconbefore',
                        reason: 'select.single.local.iconbefore error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'select.single.local.iconafter',
                        reason: 'select.single.local.iconafter error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'select.single.local.icons',
                        reason: 'select.single.local.icons error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'select.single.remote',
                        reason: 'select.single.remote error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'select.multiple.remote',
                        reason: 'select.multiple.remote error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'radio.vertical',
                        reason: 'Vertical radio validation error message'
                    }, {
                        type: 'FIELD_ERROR',
                        context: 'radio.horizontal',
                        reason: 'Horizontal radio validation error message'
                    }, {
                        type: 'GLOBAL_ERROR',
                        reason: 'globally broken'
                    }]);
                };
            });

            document.querySelectorAll('ful-select').forEach(sel => {
                sel.loader = async (q, type) => {
                    if (type === 'id') {
                        return [
                            { value: q, text: q + "-asd" }
                        ];
                    }
                    await sleep(3_000);
                    return [
                        { value: "1", text: "asd" },
                        { value: "2", text: "bsd" }
                    ]
                };
            })


        });
    </script>
</body>

</html>